# Outlier Data Management System

실험 및 생산 데이터의 이상치 자동 검출·제거, 통계 분석, 시각화 및 비교 분석을 위한 종합적인 웹 애플리케이션입니다.

## 주요 기능

### 🔍 **이상치 검출 및 제거**
- **3가지 이상치 검출 방법**:
  - Z-Score (표준편차 기반)
  - IQR (사분위수 기반) 
  - MAD (중앙절대편차 기반)
- **동적 임계값 조정**: 실시간 슬라이더로 임계값 조정 가능
- **실시간 통계 계산**: 평균, 표준편차, 중앙값 등 자동 계산

### 📊 **데이터 관리**
- **다중 입력 방식**: 직접 입력, Excel/CSV 파일 업로드
- **유연한 데이터 구조**: 동적 행/컬럼 추가, 사용자 정의 측정 항목
- **멀티 샘플 관리**: 샘플명, 생산일자, 패스 수(회차) 추적
- **데이터셋 저장/불러오기**: 세션 기반 데이터 관리

### 📈 **시각화 및 분석**
- **인터랙티브 차트**: Plotly 기반 산점도 및 이상치 표시
- **패스별 트렌드 분석**: Size/PI 값의 패스별 변화 추이 및 상관관계 분석
- **점도 상관관계 분석**: Size(μm) vs 점도 상관관계 시각화 (draw_plot.py 스타일)
- **데이터셋 비교**: 여러 데이터셋 간 통계 비교 분석
- **종합 대시보드**: 원본/필터링 데이터 동시 표시

### 💾 **결과 내보내기**
- **CSV 다운로드**: 원본 데이터, 필터링 데이터, 통계 결과 포함
- **시각화 저장**: 차트 이미지 다운로드 지원

## 사용 방법

### 1. 기본 정보 입력
1. **샘플명**: 분석할 샘플의 이름을 입력하세요
2. **생산일자**: 샘플의 생산 또는 실험 날짜를 선택하세요
3. **패스 수(회차)**: 동일 샘플에 대한 측정 회차를 입력하세요 (1차, 2차, 3차...)
   - 예: 같은 샘플을 3번 측정한 경우 각각 1, 2, 3으로 구분

### 2. 데이터 입력 방법
#### 📝 **직접 입력**
- 테이블의 각 셀에 직접 숫자 데이터를 입력
- 기본 컬럼: size(µm), PI 값
- **행 추가**: 새로운 데이터 행 추가
- **컬럼 추가**: 사용자 정의 측정 항목 추가 (예: 온도, 압력 등)

#### 📁 **파일 업로드**
- 지원 형식: Excel (.xlsx, .xls), CSV (.csv)
- 자동 컬럼 매핑: size, nm, PI 등의 컬럼 자동 인식
- 기타 숫자 컬럼도 자동으로 가져오기

### 3. 임계값 조정 및 계산
1. **임계값 조정**: 각 방법별 슬라이더로 임계값을 실시간 조정
   - Z-Score: 1.0 ~ 5.0 (권장: 2.0~3.0)
   - IQR: 0.5 ~ 3.0 (권장: 1.5~2.0)
   - MAD: 1.0 ~ 5.0 (권장: 3.0~4.0)

2. **이상치 검출 및 계산**: 버튼 클릭으로 3가지 방법 동시 실행
3. **결과 확인**: 원본 데이터, 필터링 데이터, 통계 결과, 시각화 차트 표시

### 4. 패스별 평균값 관리
1. **평균값 입력**:
   - **수동 입력**: 패스 번호, Size(µm) 평균, PI 평균을 직접 입력
   - **계산 결과 활용**: 이상치 검출 결과에서 "계산 결과에서 평균값 추가" 버튼 클릭
   - **점도 데이터**: 선택적으로 점도값 (cP) 함께 저장

2. **트렌드 분석**:
   - **패스별 트렌드**: Size/PI 값의 패스별 변화 추이 시각화
   - **상관관계 분석**: Size-PI 간 상관계수 계산 및 시각화
   - **통계 요약**: 평균, 표준편차, 변동계수 등 종합 통계

3. **점도 상관관계 분석**:
   - **조건**: 점도 데이터 2개 이상 필요
   - **시각화**: Size(μm) vs 점도 산점도 차트 (draw_plot.py 스타일)
   - **기준값 비교**: UHV, HV, LV 기준값과 생산 데이터 비교
   - **상관계수**: Size-점도 간 상관관계 수치 제공

### 5. 데이터셋 관리
- **저장**: 현재 데이터셋을 이름을 지정하여 저장
- **불러오기**: 이전에 저장한 데이터셋 불러오기
- **비교**: 여러 데이터셋 간 통계 비교 분석
- **초기화**: 모든 데이터 및 결과 초기화

### 6. 결과 해석 및 내보내기

#### 📊 **결과 화면 구성**
- **원본 데이터 통계**: 필터링 전 전체 데이터 통계
- **필터링 데이터 통계**: 이상치 제거 후 데이터 통계
- **이상치 정보**: 각 방법별 제거된 이상치 개수 및 비율
- **시각화 차트**: 원본 데이터와 이상치가 표시된 산점도

#### 🔍 **이상치 검출 방법별 특징**
- **Z-Score 방법**: 표준편차를 기준으로 이상치 제거 (정규분포 가정)
- **IQR 방법**: 사분위수 범위를 기준으로 이상치 제거 (분포 독립적)
- **MAD 방법**: 중앙절대편차를 기준으로 이상치 제거 (로버스트 통계)

#### 💾 **결과 다운로드**
- **CSV 파일**: 원본/필터링 데이터, 통계 결과, 메타데이터 포함
- **파일 구성**: 
  - 샘플 정보 (샘플명, 생산일자, 패스 수)
  - 원본 데이터 및 통계
  - 각 방법별 필터링 결과 및 통계
  - 이상치 제거 정보

## 기술 스택

- **Backend**: Flask (Python 3.12)
- **Frontend**: HTML5, Tailwind CSS, JavaScript
- **데이터 처리**: Pandas, NumPy, SciPy
- **시각화**: Plotly, Matplotlib, Seaborn
- **통계 분석**: 상관계수, 트렌드 분석, 변동계수 계산
- **파일 처리**: OpenPyXL, XlsxWriter
- **배포**: Azure Web App

## 로컬 실행

```bash
# 의존성 설치
pip install -r requirements.txt

# 개발 서버 실행
python app.py

# 브라우저에서 http://localhost:8000 접속
```

## Azure 배포

```bash
# Azure CLI 로그인
az login

# 웹앱 생성
az webapp create --resource-group <resource-group> --plan <app-service-plan> --name <app-name> --runtime "PYTHON|3.12"

# 코드 배포
az webapp deployment source config-zip --resource-group <resource-group> --name <app-name> --src <zip-file>
```

## 파일 구조

```
outlier-webapp/
├── app.py              # Flask 애플리케이션
├── requirements.txt    # Python 의존성
├── startup.sh         # Azure 시작 스크립트
├── templates/
│   └── index.html     # 메인 HTML 템플릿
└── README.md          # 사용 설명서
```

## 주요 특징

### 🧪 **고급 분석 기능**
- **패스별 트렌드 분석**: 연속 공정에서 패스별 품질 변화 추적
- **점도 상관관계 분석**: 입자 크기와 점도 간 상관관계 시각화
- **기준값 비교**: UHV, HV, LV 기준값 대비 생산 데이터 위치 분석
- **다중 인자 통계**: 상관계수, 트렌드, 변동계수 종합 분석

### 🚀 **성능 최적화**
- 세션 기반 데이터 관리 (데이터베이스 불필요)
- 실시간 임계값 조정 및 즉시 반영
- 경량화된 프론트엔드 (CDN 기반 라이브러리)

### 🔒 **데이터 보안**
- 클라이언트 측 데이터 처리 (서버 저장 없음)
- 세션 기반 임시 저장 (브라우저 종료 시 자동 삭제)
- 파일 업로드 검증 및 크기 제한 (16MB)

### 🌐 **배포 최적화**
- Azure Web App Free Tier 호환
- 데이터베이스 의존성 없음
- 확장 가능한 아키텍처

## 사용 제한 및 권장사항

### ⚠️ **사용 제한**
1. **데이터 형식**: 모든 측정값은 숫자여야 함
2. **최소 데이터**: 통계 계산을 위해 최소 3개 이상의 유효한 데이터 필요
3. **세션 유지**: 브라우저 종료 시 데이터 자동 삭제
4. **파일 크기**: 업로드 파일 최대 16MB

### 💡 **권장사항**
- 중요한 데이터는 CSV 다운로드를 통해 별도 백업
- 임계값 조정 시 도메인 전문 지식 활용
- 여러 방법의 결과를 종합적으로 비교 분석
- 데이터셋 비교 기능을 통한 재현성 검증

## 문제 해결

### 🔧 **일반적인 문제**
- **계산 오류**: 빈 값이나 문자 데이터 확인, 최소 데이터 개수 확인
- **파일 업로드 실패**: 파일 형식 및 크기 확인, 컬럼명 매핑 확인
- **페이지 로딩 문제**: 브라우저 캐시 삭제, 개발자 도구 콘솔 확인
- **차트 표시 오류**: JavaScript 활성화 확인, 브라우저 호환성 확인

### 📞 **지원 및 도움말**
- 애플리케이션 내 도움말 모달 참조
- 각 기능별 상세 사용법 및 예제 제공
- GitHub Issues 활용

## 버전 정보

- **현재 버전**: 2.1.0
- **최종 업데이트**: 2025-07-08
- **주요 업데이트**:
  - **패스별 평균값 관리 시스템**: 패스별 Size/PI 평균값 저장 및 관리
  - **점도 데이터 연동 기능**: 패스별 점도값 입력 및 Size-점도 상관관계 분석
  - **트렌드 분석 기능**: Size/PI 값의 패스별 변화 추이 시각화
  - **draw_plot.py 스타일 시각화**: 기준값 대비 생산 데이터 비교 차트
  - **도움말 모달 통합**: 점도 관련 설명을 포함한 종합 사용 가이드
  - 동적 임계값 조정 기능 추가
  - Plotly 기반 인터랙티브 시각화 구현
  - 다중 데이터셋 관리 및 비교 기능 추가
  - Tailwind CSS 기반 UI 리디자인
  - 파일 업로드/다운로드 기능 강화

## 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.